
# 패션 룩 세부 분석 AI

이 프로젝트는 패션 룩을 세부적으로 분석하기 위해 YOLO 모델을 활용한 AI 시스템입니다. 이미지 URL을 통해 패션 아이템을 감지하고, 이를 기반으로 클러스터링된 결과를 외부 서버와 연동하여 제공합니다.

## 프로젝트 개요

**목적**: 패션 이미지의 세부 룩을 분석하고, 이를 기반으로 한 클러스터링을 수행

### 기능:
- 이미지 URL을 통해 이미지 다운로드 및 전처리
- YOLO 모델을 사용한 객체 감지 및 클래스 확률 계산
- 6D 벡터 생성 및 외부 클러스터링 서버와의 연동
- Flask API를 통한 외부 요청 처리 및 응답 제공

## 주요 기능

### 이미지 처리 및 예측:
- 이미지 URL로부터 이미지 다운로드
- YOLO 모델을 사용한 객체 감지 및 클래스 확률 계산

### 6D 벡터 생성:
- 단일 이미지 또는 두 개의 이미지를 기반으로 6D 벡터 생성
- 메인 이미지와 서브 이미지의 클래스 확률을 결합하여 벡터 생성

### 외부 클러스터링 서버와 연동:
- 생성된 벡터를 외부 클러스터링 서버로 전송
- 클러스터링 결과를 클라이언트에 반환

## 요구사항

- Python 3.7 이상

### 필수 라이브러리:
- numpy
- requests
- ultralytics
- Pillow
- Flask
- logging

## 설치 방법

1. 저장소 클론:

    ```bash
    git clone <저장소 URL>
    cd <저장소 디렉토리>
    ```

2. 가상 환경 설정 (선택 사항):

    ```bash
    python -m venv venv
    source venv/bin/activate  # Linux/Mac
    venv\Scripts\activate     # Windows
    ```

3. 필요한 라이브러리 설치:

    ```bash
    pip install -r requirements.txt
    ```

4. YOLO 모델 파일 준비:

    - `best.pt` 파일을 프로젝트 루트 디렉토리에 위치시킵니다.

## 사용법

1. 서버 실행:

    ```bash
    python app.py
    ```

    서버는 `0.0.0.0`의 `5001` 포트에서 실행됩니다.

2. API 요청:

    - **엔드포인트**: `/process_images`
    - **메서드**: POST

### 입력:

- `image_urls`: 이미지 URL 리스트 (1개 또는 2개)

### 응답:

#### 성공 시: 분석 결과 및 클러스터링 서버 응답
#### 실패 시: 에러 메시지

## API 상세 설명

### /process_images (POST)

- **설명**: 제공된 이미지 URL을 처리하여 패션 룩을 분석하고 클러스터링 결과를 반환합니다.

#### 입력:

```json
{
    "image_urls": [
        "http://example.com/image1.jpg",
        "http://example.com/image2.jpg"
    ]
}
```

- `image_urls`: 분석할 이미지의 URL 리스트 (1개 또는 2개)

#### 출력:

- **성공 (200)**:

    - 이미지가 1개일 경우:

    ```json
    {
        "top_class": {
            "class": "chic_look",
            "confidence": 0.95
        },
        "response": { ... }  // 외부 클러스터링 서버 응답
    }
    ```

    - 이미지가 2개일 경우:

    ```json
    {
        "response": { ... }  // 외부 클러스터링 서버 응답
    }
    ```

- **실패**:
    - 잘못된 입력, 이미지 처리 오류, 외부 서버 통신 오류 등 다양한 에러 메시지 반환

## 모델 설명

- **YOLO 모델**: 경량 객체 검출 모델인 YOLO를 사용하여 이미지 내 객체를 감지
- **best.pt**: 사전 학습된 YOLO 모델 파일
- **감지 클래스**: casual_look, classic_look, minimal_look, chic_look, sporty_look, street_look, person

## 로깅 및 에러 처리

- **로깅 설정**:

    - INFO 레벨로 로깅 설정
    - 주요 이벤트 및 에러 상황을 로그로 기록

- **에러 처리**:

    - 이미지 다운로드 실패, 객체 감지 실패, 외부 서버 통신 오류 등 다양한 예외 상황을 처리
    - 적절한 HTTP 상태 코드와 에러 메시지 반환

## 외부 클러스터링 서버 연동

- **서버 URL**: `http://j11e104a.p.ssafy.io:5000/predict`
- **요청 형식**:

    ```json
    {
        "point": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6]
    }
    ```

- **응답 처리**:
    - 외부 서버의 응답을 클라이언트에 그대로 전달
    - 응답 상태에 따라 적절한 에러 메시지 반환

## 기타

- **호스트 및 포트**:
    - 호스트: `0.0.0.0`
    - 포트: `5001`

- **언어**: Python
- **프레임워크**: Flask
