# 자율 주차 인공지능 프로젝트

## 프로젝트 소개

**목적**: 심층 강화학습을 활용하여 자율 주차 인공지능을 개발하고, 다양한 주차 환경에서의 주차 성능을 평가  
**환경**: highway_env 기반의 커스텀 주차 시뮬레이션 환경 구현  
**알고리즘**: Stable Baselines3의 Soft Actor-Critic (SAC) 알고리즘을 사용하여 에이전트 학습  

## 사용된 기술

### 프로그래밍 언어
- **Python 3.9**: 프로젝트의 주요 로직과 알고리즘 구현에 사용  
- **호환성**: 다양한 라이브러리와의 호환성이 뛰어나며, 강화학습 커뮤니티에서 널리 사용됨  

### 주요 라이브러리 및 프레임워크
1. **NumPy**  
   - **역할**: 고성능 수치 계산 및 배열 연산을 위한 라이브러리  
   - **사용 예시**: 상태 및 보상 계산, 차량의 위치, 속도 등의 수치 데이터 처리  

2. **Gymnasium**  
   - **역할**: 강화학습 환경을 정의하고 인터페이스를 제공하는 라이브러리  
   - **사용 예시**: 커스텀 주차 환경(ParkingEnv)을 Gym 인터페이스에 맞게 구현, 환경의 초기화, 상태 관찰, 행동 적용, 보상 반환 등의 기능 제공  

3. **Highway Environment (highway_env)**  
   - **역할**: 자율 주행 시뮬레이션을 위한 환경을 제공하는 라이브러리  
   - **사용 예시**: 도로 네트워크, 차선, 차량 객체 등의 시뮬레이션 요소 구성, 차량의 물리적 특성 및 주행 로직 구현  

4. **Stable Baselines3**  
   - **역할**: 강화학습 알고리즘을 손쉽게 구현하고 사용할 수 있게 해주는 라이브러리  
   - **사용 예시**: Soft Actor-Critic (SAC) 알고리즘을 사용하여 에이전트 학습, 학습된 모델의 저장 및 로드 기능 활용  

5. **PyTorch**  
   - **역할**: 딥러닝 모델 구현 및 학습을 위한 프레임워크  
   - **사용 예시**: SAC 알고리즘의 신경망 모델 구현, GPU 가속을 통한 빠른 연산 처리  

6. **ImageIO 및 OpenCV (cv2)**  
   - **역할**: 이미지 및 비디오 처리 라이브러리  
   - **사용 예시**: 시뮬레이션 에피소드의 시각적 결과를 GIF 및 MP4 형식으로 저장, 주차 시뮬레이션의 이미지 캡처 및 동영상 생성  

7. **기타 라이브러리**  
   - **ABC (Abstract Base Classes)**: 추상 클래스 정의를 통해 공통 인터페이스 제공  
   - **Typing**: 코드의 타입 힌팅을 통해 가독성 및 유지보수성 향상  

## 주요 클래스 및 모듈

1. **GoalEnv**  
   - **역할**: 목표 기반 강화학습 환경의 추상 클래스  
   - **기능**: compute_reward 메서드를 통해 목표 달성도에 따른 보상 계산  

2. **ParkingEnv**  
   - **역할**: 자율 주차 시뮬레이션을 위한 커스텀 환경 클래스  
   - **기능**: 주차 공간 및 도로 네트워크 생성, 차량 및 장애물 초기화, 관찰 공간 및 행동 공간 정의, 보상 함수 및 성공 조건 설정, 환경 리셋 및 스텝 함수 구현  

3. **ParkingEnvActionRepeat 및 ParkingEnvParkedVehicles**  
   - **역할**: ParkingEnv의 서브클래스로, 특정 설정을 가진 환경 변형 제공  
   - **기능**: 정책 빈도 및 시뮬레이션 지속 시간 설정, 주차된 차량의 추가 설정  

## 학습 및 평가 과정

### 1. 모델 학습
- **알고리즘**: Soft Actor-Critic (SAC)  
- **특징**: 탐사와 활용의 균형을 유지하며, 안정적인 학습을 제공하는 오프폴리시 강화학습 알고리즘  
- **장점**: 연속적인 행동 공간에 적합하며, 높은 샘플 효율성을 보임  
- **학습 과정**: ParkingEnv 환경에서 에이전트가 주차 작업을 학습, 에이전트는 주차 성공 및 충돌 방지를 목표로 보상 신호를 최적화  

### 2. 모델 평가
- **평가 방법**: 학습된 SAC 모델을 로드하여 테스트 환경에서 성능 평가, 10회 에피소드 실행을 통해 에이전트의 주차 성능 측정  
- **결과 시각화**: 최고 보상 에피소드의 시뮬레이션 결과를 GIF 및 MP4 형식으로 저장하여 시각적으로 확인  

## 환경 설정 및 커스터마이징

1. **주차 공간 및 도로 네트워크 설정**  
   - **주차 공간 수**: 기본 4개로 설정, 필요에 따라 변경 가능  
   - **도로 네트워크**: 직선 차선으로 구성되며, 주차 공간의 위치 및 길이 설정 가능  

2. **차량 및 장애물 설정**  
   - **차량 수**: 제어되는 차량 수 및 주변 차량 수 설정 가능  
   - **장애물 추가**: 환경 내 벽 및 장애물 추가 여부 설정 가능  

3. **보상 함수 파라미터**  
   - **보상 가중치**: 차량의 위치, 속도, 방향 등의 요소에 대한 가중치 설정  
   - **성공 시 보상**: 주차 성공 시 추가 보상  
   - **충돌 시 패널티**: 충돌 발생 시 패널티 부여  

4. **시뮬레이션 파라미터**  
   - **시뮬레이션 주파수**: 초당 업데이트 횟수 설정  
   - **에피소드 지속 시간**: 한 에피소드의 최대 단계 수 설정  
   - **화면 설정**: 시뮬레이션 화면의 크기 및 중심 위치 설정  

## 결과 저장 및 시각화

1. **GIF 저장**  
   - **기능**: 최고 보상 에피소드의 이미지를 GIF 파일로 저장  
   - **설정**: 저장 경로: output/best_parking_simulation.gif, 프레임 속도 및 슬로우 팩터 조절 가능  

2. **MP4 저장**  
   - **기능**: 최고 보상 에피소드의 이미지를 MP4 파일로 저장  
   - **설정**: 저장 경로: output/best_parking_simulation.mp4, 비디오 코덱 및 프레임 속도 설정 가능  

## 설치 방법

1. **Python 설치**  
   - Python 3.9 버전 권장  

2. **필요 라이브러리 설치**  
   - 제공된 requirements.txt 파일을 사용하여 정확한 버전의 라이브러리 설치  
   ```bash
   pip install -r requirements.txt
   ```

3. **프로젝트 파일 다운로드**  
   - 해당 프로젝트의 소스 코드를 클론 또는 다운로드  
   ```bash
   git clone https://github.com/your-repo/auto-parking-ai.git
   cd auto-parking-ai
   ```

## 요구사항

- **소프트웨어**: Windows, macOS, Linux 등  
- **필수 라이브러리**: numpy, gymnasium, highway-env, stable-baselines3, torch, imageio, opencv-python  
- **하드웨어**: CUDA 지원 GPU 권장, RAM 8GB 이상  


